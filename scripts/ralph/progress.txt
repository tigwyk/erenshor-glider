# Ralph Progress Log
Started: Wed Feb  5 06:30:00 PST 2026
Branch: ralph/game-integration
Feature: Replace stub implementations with real Erenshor game API integration using Assembly-CSharp.dll
---

## [2025-02-05] - US-001
- Added conditional compilation support for toggling between stub and real game types
- Added USE_REAL_GAME_TYPES compilation constant to csproj
- Added conditional assembly references to Assembly-CSharp.dll and UnityEngine.dll (only active when USE_REAL_GAME_TYPES=true and ERENSHOR_PATH is set)
- Wrapped GameStubs/GameData.cs with #if !USE_REAL_GAME_TYPES to exclude stubs when using real types
- Updated GameStateReader.cs to conditionally use stubs
- Fixed pre-existing nullable reference warnings in RestController.cs, RotationExecutor.cs, ExportImportManager.cs, and GrindingBot.cs
- Suppressed unused event warning in Navigation.cs

**Files changed:**
- src/ErenshorGlider/ErenshorGlider.csproj - Added conditional assembly references
- src/ErenshorGlider/GameStubs/GameData.cs - Added #if !USE_REAL_GAME_TYPES wrapper
- src/ErenshorGlider/GameState/GameStateReader.cs - Added conditional using statement
- src/ErenshorGlider/Navigation/Navigation.cs - Suppressed CS0067
- src/ErenshorGlider/Combat/RestController.cs - Fixed nullable warnings
- src/ErenshorGlider/Combat/RotationExecutor.cs - Fixed nullable warnings
- src/ErenshorGlider/ImportExport/ExportImportManager.cs - Fixed nullable warnings
- src/ErenshorGlider/Bot/GrindingBot.cs - Fixed nullable warnings

**Learnings for future iterations:**
- The project uses `Nullable` enabled type checking, which requires careful handling of nullable reference types
- When USE_REAL_GAME_TYPES is defined but ERENSHOR_PATH is not set, the build shows a warning but still attempts to compile
- The stub types (GameData, PlayerControl, Character, etc.) need to match the real game API signatures exactly for the conditional compilation to work seamlessly
- The ItemQuality enum exists in both GameState namespace (used by PlayerInventory struct) and GameStubs namespace - these are intentionally separate
- The prd.json branch name was "ralph/game-integration" but the actual branch was "ralph/erenshor-glider" - created new branch as specified

**Build verification:**
- Default build (without USE_REAL_GAME_TYPES): PASS (0 warnings, 0 errors)
- With USE_REAL_GAME_TYPES but no ERENSHOR_PATH: Fails (expected - needs actual game DLLs)
---

## [2025-02-05] - US-002
- Created ErenshorGlider.Tests project for unit testing without game dependencies
- Moved GameStubs classes to test project (GameStubs/GameData.cs) - copies remain in main project with conditional compilation
- Added TestStubsSetup helper class for convenient mock object creation
- Created PositionTrackerTests with 17 unit tests covering GameStateReader, PlayerPosition, PlayerVitals, CombatState, and TargetInfo
- Test project compiles independently of game assemblies using UnityEngine.Modules NuGet package
- All projects build with 0 warnings, 0 errors

**Files changed:**
- src/ErenshorGlider.Tests/ErenshorGlider.Tests.csproj - New test project with xUnit
- src/ErenshorGlider.Tests/GameStubs/GameData.cs - Stub implementations for testing
- src/ErenshorGlider.Tests/Helpers/TestStubsSetup.cs - Helper for creating mock game objects
- src/ErenshorGlider.Tests/GameState/PositionTrackerTests.cs - 17 unit tests

**Learnings for future iterations:**
- The test project targets .NET Framework 4.7.2 (same as main project) and uses xUnit for testing
- UnityEngine.Modules NuGet package provides Unity type stubs for compilation without game DLLs
- Tests require mono runtime to execute on Linux (not installed in current environment) but compile successfully
- Used null-forgiving operator (!) to suppress nullable warnings when assigning null to non-nullable stub fields
- Fully qualified type names (e.g., GameStubs.ItemQuality) needed to avoid ambiguity with GameState.ItemQuality

**Build verification:**
- ErenshorGlider.Tests build: PASS (0 warnings, 0 errors)
- Test execution: Requires mono/.NET Framework runtime on Windows
---
