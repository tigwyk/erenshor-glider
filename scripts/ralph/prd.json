{
  "project": "Erenshor Glider",
  "branchName": "ralph/auto-installation",
  "description": "Automated BepInEx installation and plugin management - eliminate manual BepInEx installation, auto-detect Erenshor via Steam, one-click plugin installation/updates, and integrated game launching through the GUI.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create installation service infrastructure",
      "description": "As a developer, I need a service layer for installation operations so the GUI can manage BepInEx and plugin installation.",
      "acceptanceCriteria": [
        "Create IInstallationService interface with DownloadBepInEx, DetectErenshorPath, InstallBepInEx methods",
        "Create InstallationService class implementing IInstallationService",
        "Add HttpClient for downloading from GitHub releases",
        "Add BepInExDownloadUrl constant pointing to official releases",
        "Add CacheDirectory property for local file caching",
        "Create InstallationResult model class with Success, ErrorMessage properties",
        "Create InstallationStatus enum (NotInstalled, Installed, UpdateAvailable)",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Implement Steam registry Erenshor detection",
      "description": "As a user, I want the GUI to automatically find my Erenshor installation via Steam registry.",
      "acceptanceCriteria": [
        "Add DetectErenshorPathFromSteam method using Microsoft.Win32.Registry",
        "Query HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Steam App 2879460",
        "Fallback to HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node for 32-bit Steam on 64-bit Windows",
        "Return InstallLocation value or null if not found",
        "Validate returned path contains Erenshor.exe",
        "Handle registry access exceptions gracefully",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Implement BepInEx download with progress reporting",
      "description": "As a user, I want BepInEx downloaded automatically with visible progress.",
      "acceptanceCriteria": [
        "Add DownloadBepInExAsync method accepting IProgress&lt;DownloadProgress&gt;",
        "Create DownloadProgress model with BytesReceived, TotalBytes, Percentage properties",
        "Download latest BepInEx x64 release from GitHub releases URL",
        "Save to cache directory (LocalApplicationData/ErenshorGlider/cache)",
        "Report progress during download",
        "Return cached file path if already exists",
        "Handle download failures with clear error messages",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Implement BepInEx extraction and installation",
      "description": "As a user, I want BepInEx automatically extracted to my Erenshor folder.",
      "acceptanceCriteria": [
        "Add InstallBepInEx method accepting erenshorPath and archivePath",
        "Extract BepInEx zip archive to Erenshor root using System.IO.Compression",
        "Create BepInEx/plugins folder if missing",
        "Backup existing doorstop_config.dll if present",
        "Return InstallationResult with Success=true on completion",
        "Handle file locked errors with helpful message",
        "Validate installation by checking for BepInEx/core/BepInEx.dll",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Implement plugin DLL installation",
      "description": "As a user, I want one-click plugin installation to BepInEx plugins folder.",
      "acceptanceCriteria": [
        "Add InstallPlugin method accepting sourceDllPath and erenshorPath",
        "Copy ErenshorGlider.dll to BepInEx/plugins folder",
        "Overwrite existing plugin if present",
        "Create BepInEx/plugins folder if missing",
        "Return InstallationResult indicating success or failure",
        "Handle file locked errors (game running) with helpful message",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Implement GitHub version checking for plugin updates",
      "description": "As a user, I want the GUI to notify me when a plugin update is available.",
      "acceptanceCriteria": [
        "Add CheckForUpdatesAsync method to InstallationService",
        "Query GitHub API for latest ErenshorGlider release",
        "Parse version from release tag_name",
        "Compare with current assembly version",
        "Return UpdateCheckResult with HasUpdate, LatestVersion, CurrentVersion",
        "Handle offline mode gracefully (return HasUpdate=false)",
        "Handle GitHub API rate limiting",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Implement plugin download and update installation",
      "description": "As a user, I want one-click plugin updates when new versions are available.",
      "acceptanceCriteria": [
        "Add UpdatePluginAsync method accepting IProgress&lt;DownloadProgress&gt;",
        "Download latest release asset DLL from GitHub",
        "Backup existing DLL before update",
        "Install new DLL to BepInEx/plugins folder",
        "Report download and installation progress",
        "Return InstallationResult with new version number",
        "Handle download failures with clear error messages",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Implement game process management",
      "description": "As a user, I want to launch Erenshor through the GUI and detect when it's running.",
      "acceptanceCriteria": [
        "Add IsGameRunning method checking for Erenshor.exe process",
        "Add LaunchGame method accepting erenshorPath",
        "Start Erenshor.exe process using System.Diagnostics.Process",
        "Return Process object for monitoring",
        "Handle process start failures with clear error messages",
        "Add GameExited event for process termination notification",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Add installation configuration persistence",
      "description": "As a user, I want my Erenshor path remembered so I don't have to select it each time.",
      "acceptanceCriteria": [
        "Add InstallationConfig class with ErenshorPath property",
        "Add InstallationConfigManager for load/save operations",
        "Save config to LocalApplicationData/ErenshorGlider/installation.json",
        "Load config on service initialization",
        "Return null if config file doesn't exist",
        "Handle JSON deserialization errors gracefully",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Create installation status display panel",
      "description": "As a user, I want to see installation status at a glance in the GUI.",
      "acceptanceCriteria": [
        "Create InstallationStatusPanel control in ErenshorGlider.GUI/Controls",
        "Show BepInEx status with icon (✓ installed, ⚠ update available, ✗ not installed)",
        "Show plugin status with icon",
        "Display installed versions for both BepInEx and plugin",
        "Add Refresh button to check installation status",
        "Style panel to match existing GUI theme",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": "InstallationStatusPanel with icon indicators (✓/⚠/✗), version display, path label, Refresh button, auto-refresh every 5 seconds. Version detection via version.txt and FileVersionInfo."
    },
    {
      "id": "US-011",
      "title": "Add installation buttons to main window",
      "description": "As a user, I want buttons to install BepInEx and the plugin from the main GUI.",
      "acceptanceCriteria": [
        "Add InstallPlugin button to MainWindow header area",
        "Add LaunchGame button to MainWindow header area",
        "Buttons disable when game is running",
        "Install button shows confirmation message on success",
        "Launch button starts Erenshor.exe from configured path",
        "Show error dialog if Erenshor path not configured",
        "Style buttons to match existing theme",
        "Typecheck passes"
      ],
      "priority": 11,
      "passes": true,
      "notes": "Added InstallPlugin and LaunchGame buttons to MainWindow header. Buttons disable when game is running. Shows confirmation/error dialogs. Added IInstallationService constructor parameter."
    },
    {
      "id": "US-012",
      "title": "Create first-run setup wizard",
      "description": "As a new user, I want a guided setup wizard for initial installation.",
      "acceptanceCriteria": [
        "Create SetupWizard Form with multi-step layout",
        "Step 1: Welcome screen with 'Get Started' button",
        "Step 2: Erenshor detection with auto-detected path or manual browse button",
        "Step 3: BepInEx installation with progress bar",
        "Step 4: Plugin installation with progress bar",
        "Step 5: Complete screen with 'Launch Game' button",
        "Add Back/Next/Cancel navigation buttons",
        "Wizard launches on first run if no installation detected",
        "Typecheck passes"
      ],
      "priority": 12,
      "passes": true,
      "notes": "Created SetupWizard Form in ErenshorGlider.GUI/Forms with 5 steps (Welcome, Detection, BepInEx, Plugin, Complete). Includes Back/Next/Cancel navigation, progress bars, auto-detect from Steam, manual folder browser, and path validation."
    },
    {
      "id": "US-013",
      "title": "Add manual directory browser dialog",
      "description": "As a user, I want to manually browse for Erenshor if auto-detection fails.",
      "acceptanceCriteria": [
        "Add BrowseForErenshorPath method to InstallationService",
        "Use FolderBrowserDialog for directory selection",
        "Validate selected path contains Erenshor.exe",
        "Return validated path or null if cancelled/invalid",
        "Show clear error message for invalid selection",
        "Persist selected path to InstallationConfig",
        "Typecheck passes"
      ],
      "priority": 13,
      "passes": true,
      "notes": "Added BrowseForErenshorPathAsync method to IInstallationService and InstallationService. Uses FolderBrowserDialog for directory selection, validates Erenshor.exe exists, shows error message on invalid selection. Uses SynchronizationContext to show dialog on UI thread."
    },
    {
      "id": "US-014",
      "title": "Add update notification display",
      "description": "As a user, I want to see when a plugin update is available.",
      "acceptanceCriteria": [
        "Show notification balloon when update is available on startup",
        "Display update notification in installation status panel",
        "Include 'Update Now' button when update available",
        "Show changelog/release notes for new version",
        "Notification doesn't block GUI startup (async check)",
        "Typecheck passes"
      ],
      "priority": 14,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-015",
      "title": "Implement installation repair function",
      "description": "As a user, I want to repair my installation if something goes wrong.",
      "acceptanceCriteria": [
        "Add RepairInstallation method to InstallationService",
        "Reinstall BepInEx files from cached archive",
        "Reinstall plugin DLL from current GUI directory",
        "Validate all core BepInEx DLLs exist",
        "Return detailed RepairResult with FixedItems and RemainingIssues",
        "Log repair operations to action log",
        "Typecheck passes"
      ],
      "priority": 15,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-016",
      "title": "Implement uninstall function",
      "description": "As a user, I want to cleanly remove BepInEx and plugin if I stop using the bot.",
      "acceptanceCriteria": [
        "Add Uninstall method to InstallationService",
        "Show confirmation dialog with warning",
        "Remove BepInEx folder and all contents",
        "Remove doorstop_config.dll from Erenshor root",
        "Remove plugin DLL from BepInEx/plugins",
        "Optionally backup config files before uninstall",
        "Return success result after completion",
        "Typecheck passes"
      ],
      "priority": 16,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-017",
      "title": "Add installation settings to settings panel",
      "description": "As a user, I want to access installation options from the settings menu.",
      "acceptanceCriteria": [
        "Add Installation tab to SettingsPanel",
        "Show current Erenshor path with Change button",
        "Add Repair Installation button",
        "Add Uninstall button",
        "Show BepInEx and plugin versions",
        "Add check for updates button",
        "Style to match existing settings tabs",
        "Typecheck passes"
      ],
      "priority": 17,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-018",
      "title": "Add download integrity verification",
      "description": "As a user, I want downloaded files verified for security.",
      "acceptanceCriteria": [
        "Add SHA256 checksum verification for BepInEx download",
        "Compare downloaded file hash against expected value",
        "Fail installation with clear error if hash mismatch",
        "Log checksum verification results",
        "Handle missing checksum data gracefully",
        "Typecheck passes"
      ],
      "priority": 18,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-019",
      "title": "Add game running status to main window",
      "description": "As a user, I want to see if Erenshor is running from the GUI.",
      "acceptanceCriteria": [
        "Add game status indicator to MainWindow status strip",
        "Show 'Game Running' when Erenshor.exe process detected",
        "Show 'Game Not Running' when no process found",
        "Update status every 5 seconds via timer",
        "Change LaunchGame button to 'Game Running' when game active",
        "Disable plugin installation when game is running",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-020",
      "title": "Integrate InstallationService with MainWindow",
      "description": "As a developer, I need the installation service wired up to the main UI.",
      "acceptanceCriteria": [
        "Add IInstallationService property to MainWindow",
        "Instantiate InstallationService in MainWindow constructor",
        "Wire up InstallPlugin button click to InstallPluginAsync",
        "Wire up LaunchGame button click to LaunchGame",
        "Handle installation errors with message boxes",
        "Update status labels on installation completion",
        "Start game status polling timer on window load",
        "Typecheck passes"
      ],
      "priority": 20,
      "passes": false,
      "notes": ""
    }
  ]
}
